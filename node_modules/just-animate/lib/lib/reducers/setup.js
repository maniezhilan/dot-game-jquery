Object.defineProperty(exports, "__esModule", { value: true });
var plugins_1 = require("../core/plugins");
var effects_1 = require("../model/effects");
var lists_1 = require("../utils/lists");
var references_1 = require("../core/references");
var calc_players_1 = require("./calc-players");
function setup(model) {
    model.players = [];
    lists_1.all(model.configs, function (config) { return setupTarget(model, config); });
    calc_players_1.calculatePlayers(model);
}
exports.setup = setup;
function setupTarget(model, config) {
    var resolvedConfig = references_1.resolveRefs(model.refs, config, true);
    var effects = effects_1.toEffects(resolvedConfig);
    lists_1.all(effects, function (effect) {
        var player = plugins_1.plugins[effect.plugin].animate(effect);
        if (player) {
            player.from = effect.from;
            player.to = effect.to;
            lists_1.push(model.players, player);
        }
    });
}
exports.setupTarget = setupTarget;
