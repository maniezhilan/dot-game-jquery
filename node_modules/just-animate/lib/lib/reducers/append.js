Object.defineProperty(exports, "__esModule", { value: true });
var constants_1 = require("../utils/constants");
var inspect_1 = require("../utils/inspect");
var lists_1 = require("../utils/lists");
var insert_1 = require("./insert");
exports.append = function (model, data, ctx) {
    var cursor = model.cursor;
    var opts2 = lists_1.list(data).map(function (opt) {
        var to = opt.to, from = opt.from, duration = opt.duration;
        var hasTo = inspect_1.isDefined(to);
        var hasFrom = inspect_1.isDefined(from);
        var hasDuration = inspect_1.isDefined(duration);
        var opt2 = opt;
        opt2.to =
            hasTo && (hasFrom || hasDuration)
                ? to
                : hasDuration && hasFrom
                    ? from + duration
                    : hasTo && !hasDuration ? cursor + to : hasDuration ? cursor + duration : constants_1._;
        opt2.from =
            hasFrom && (hasTo || hasDuration)
                ? from
                : hasTo && hasDuration ? to - duration : hasTo || hasDuration ? cursor : constants_1._;
        return opt2;
    });
    insert_1.insert(model, opts2, ctx);
};
