Object.defineProperty(exports, "__esModule", { value: true });
var timeloop_1 = require("../core/timeloop");
var constants_1 = require("../utils/constants");
var update_1 = require("./update");
var actions_1 = require("../actions");
exports.play = function (model, options, ctx) {
    if (options) {
        model.repeat = options.repeat;
        model.yoyo = !!options.alternate;
        model.destroy = !!options.destroy;
    }
    model.repeat = model.repeat || 1;
    model.yoyo = model.yoyo || false;
    model.state = constants_1.S_PLAYING;
    var isForwards = model.rate >= 0;
    if (isForwards && model.time === model.duration) {
        model.time = 0;
    }
    else if (!isForwards && model.time === 0) {
        model.time = model.duration;
    }
    timeloop_1.loopOn(model.id);
    update_1.update(model, constants_1._, ctx);
    ctx.trigger(actions_1.PLAY);
};
